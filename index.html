<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>SmartMama ‚Äî –¥–∏–µ—Ç‚Äë–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js" integrity="sha512-YcsIPQqR9g0oSzmKM3v94aVn2Y1v3v6mQo6Cr6a2q9oW1mYF2fKm2U4GfA2m9n/FhNw3R3n8oYYb1J9rD14f0g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <style>
    :root {
      --bg: #0f172a;
      --card: #111827;
      --ink: #e5e7eb;
      --muted: #9ca3af;
      --primary: #22c55e;
      --warn: #f59e0b;
      --error: #ef4444;
      --ok: #10b981;
      --border: #1f2937;
    }
    * { box-sizing: border-box; }
    body {
      margin: 0; font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background: radial-gradient(1200px 600px at 80% -10%, rgba(34,197,94,.15), transparent),
                  radial-gradient(1000px 500px at 10% -10%, rgba(59,130,246,.12), transparent),
                  var(--bg);
      color: var(--ink);
      line-height: 1.5;
    }
    .container {
      max-width: 960px; margin: 24px auto; padding: 16px;
    }
    .title { font-size: 28px; font-weight: 700; margin: 8px 0 6px; }
    .subtitle { color: var(--muted); margin-bottom: 24px; }
    .card {
      background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0));
      border: 1px solid var(--border); border-radius: 14px; padding: 16px 16px;
      box-shadow: 0 8px 30px rgba(0,0,0,0.25); backdrop-filter: blur(6px);
    }
    .grid { display: grid; gap: 12px; grid-template-columns: repeat(2, minmax(0, 1fr)); }
    @media (max-width: 720px) { .grid { grid-template-columns: 1fr; } }
    label { display:block; font-weight:600; margin-bottom:6px; }
    input {
      width:100%; padding:10px 12px; border-radius:10px; border:1px solid var(--border);
      background:#0b1220; color:var(--ink); outline:none;
    }
    input:focus { border-color:#334155; }
    button {
      border:0; border-radius:10px; padding:10px 14px; font-weight:600; cursor:pointer;
      background: var(--primary); color:#06210f;
    }
    button.secondary { background:#1f2937; color:var(--ink); }
    button:disabled { opacity:.5; cursor:not-allowed; }
    .row { display:flex; gap:10px; align-items:center; flex-wrap:wrap; }
    .section-title { font-size:18px; font-weight:600; margin: 20px 0 8px; }
    .msg { border-radius:10px; padding:10px 12px; border:1px solid var(--border); }
    .msg.info { background:#0b1220; }
    .msg.warn { background: rgba(245,158,11,.15); border-color: rgba(245,158,11,.35); }
    .msg.error{ background: rgba(239,68,68,.15); border-color: rgba(239,68,68,.35); }
    .msg.ok   { background: rgba(16,185,129,.15); border-color: rgba(16,185,129,.35); }
    .muted { color: var(--muted); font-size: 13px; }
    table { width:100%; border-collapse: collapse; }
    th, td { padding: 8px 10px; border-bottom: 1px solid var(--border); text-align:left; }
    th { color: #cbd5e1; font-weight:600; background: #0b1220; }
    .menu-card {
      white-space: pre-wrap; background:#0b1220; border:1px dashed #334155;
      border-radius:12px; padding:12px;
    }
    footer { color: var(--muted); font-size: 12px; margin-top: 24px; }
  </style>
</head>
<body>
  <div class="container">
    <div class="title">ü§∞ SmartMama: –≤–∞—à –ª–∏—á–Ω—ã–π –¥–∏–µ—Ç‚Äë–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç –ø—Ä–∏ –±–µ—Ä–µ–º–µ–Ω–Ω–æ—Å—Ç–∏</div>
    <div class="subtitle">–û—Ç—Å–ª–µ–∂–∏–≤–∞–π—Ç–µ –ø—Ä–∏–±–∞–≤–∫—É –≤–µ—Å–∞ –∏ –ø–æ–ª—É—á–∞–π—Ç–µ –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –ø–∏—Ç–∞–Ω–∏—é</div>

    <div class="card">
      <div class="section-title">üìù –í–≤–µ–¥–∏—Ç–µ –≤–∞—à–∏ –¥–∞–Ω–Ω—ã–µ</div>
      <div class="grid">
        <div>
          <label>–í–µ—Å –¥–æ –±–µ—Ä–µ–º–µ–Ω–Ω–æ—Å—Ç–∏ (–∫–≥)</label>
          <input id="weight_before" type="number" min="30" max="150" step="0.1" value="60.0">
        </div>
        <div>
          <label>–†–æ—Å—Ç (—Å–º)</label>
          <input id="height" type="number" min="120" max="220" step="1" value="165">
        </div>
        <div>
          <label>–¢–µ–∫—É—â–∏–π –≤–µ—Å (–∫–≥)</label>
          <input id="current_weight" type="number" min="30" max="200" step="0.1" value="65.0">
        </div>
        <div>
          <label>–¢–µ–∫—É—â–∏–π —Å—Ä–æ–∫ (–Ω–µ–¥.)</label>
          <input id="gest_weeks" type="number" min="1" max="42" step="1" value="12">
        </div>
        <div>
          <label>–ü—Ä–µ–¥—ã–¥—É—â–∏–π –≤–µ—Å (–∫–≥, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)</label>
          <input id="prev_weight" type="number" min="0" max="200" step="0.1" value="62.0">
        </div>
        <div>
          <label>–°—Ä–æ–∫ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –≤–∑–≤–µ—à–∏–≤–∞–Ω–∏—è (–Ω–µ–¥., –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)</label>
          <input id="prev_weeks" type="number" min="0" max="42" step="1" value="11">
        </div>
      </div>
      <div class="row" style="margin-top:12px">
        <button id="calcBtn">–†–∞—Å—Å—á–∏—Ç–∞—Ç—å</button>
        <button id="downloadBtn" class="secondary" disabled>üì• –°–∫–∞—á–∞—Ç—å –º–µ–Ω—é (PDF)</button>
      </div>

      <div id="summary" style="margin-top:14px; display:grid; gap:8px;"></div>

      <div class="section-title">üìö –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –Ω–æ—Ä–º—ã –ø—Ä–∏–±–∞–≤–∫–∏ –≤–µ—Å–∞</div>
      <div class="msg info">
        <table id="norms-table"></table>
      </div>

      <div id="menuWrap" style="display:none; margin-top:12px">
        <div class="section-title">üìã –í–∞—à–µ –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –º–µ–Ω—é –Ω–∞ –¥–µ–Ω—å</div>
        <div id="menu-card" class="menu-card"></div>
      </div>

      <footer>‚ö†Ô∏è –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –Ω–æ—Å–∏—Ç —Å–ø—Ä–∞–≤–æ—á–Ω—ã–π —Ö–∞—Ä–∞–∫—Ç–µ—Ä –∏ –Ω–µ –∑–∞–º–µ–Ω—è–µ—Ç –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—é –≤—Ä–∞—á–∞.</footer>
    </div>
  </div>

  <script>
    const norms = {
      "–ò–ú–¢ < 18.5": { total_kg: "12.5‚Äì18", weekly_kg: [0.44, 0.58] },
      "–ò–ú–¢ 18.5‚Äì24.9": { total_kg: "11.5‚Äì16", weekly_kg: [0.35, 0.50] },
      "–ò–ú–¢ 25.0‚Äì29.9": { total_kg: "7‚Äì11", weekly_kg: [0.23, 0.33] },
      "–ò–ú–¢ ‚â• 30.0": { total_kg: "5‚Äì9", weekly_kg: [0.17, 0.27] },
    };

    const sampleMenus = [
`–ú–µ–Ω—é –Ω–∞ –¥–µ–Ω—å 1
–ó–∞–≤—Ç—Ä–∞–∫: –û–º–ª–µ—Ç –∏–∑ 2 —è–∏—Ü —Å —à–ø–∏–Ω–∞—Ç–æ–º + –≥—Ä–µ—á–∫–∞ (50 –≥ —Å—É—Ö.) + –∑–µ–ª—ë–Ω—ã–π —á–∞–π
–ü–µ—Ä–µ–∫—É—Å: –ô–æ–≥—É—Ä—Ç 200 –º–ª + –≥–æ—Ä—Å—Ç—å —á–µ—Ä–Ω–∏–∫–∏
–û–±–µ–¥: –ö—É—Ä–∏–Ω–∞—è –≥—Ä—É–¥–∫–∞ (120 –≥) + –±—Ä–æ–∫–∫–æ–ª–∏ (150 –≥) + –∫–∏–Ω–æ–∞ (40 –≥ —Å—É—Ö.)
–ü–µ—Ä–µ–∫—É—Å: –¢–≤–æ—Ä–æ–≥ 5% (100 –≥) + 1 —Å—Ç.–ª. —Å–µ–º—è–Ω –ª—å–Ω–∞
–£–∂–∏–Ω: –¢—Ä–µ—Å–∫–∞ –∑–∞–ø–µ—á—ë–Ω–Ω–∞—è (100 –≥) + —Å–∞–ª–∞—Ç —Å –æ–≥—É—Ä—Ü–æ–º –∏ —Ç–æ–º–∞—Ç–æ–º
–ü–µ—Ä–µ–¥ —Å–Ω–æ–º: –ö–µ—Ñ–∏—Ä 1% (200 –º–ª)`,
`–ú–µ–Ω—é –Ω–∞ –¥–µ–Ω—å 2
–ó–∞–≤—Ç—Ä–∞–∫: –¢–≤–æ—Ä–æ–∂–Ω–∞—è –∑–∞–ø–µ–∫–∞–Ω–∫–∞ (150 –≥ —Ç–≤–æ—Ä–æ–≥–∞, —è–π—Ü–æ, —è–±–ª–æ–∫–æ) + —á–∞–π
–ü–µ—Ä–µ–∫—É—Å: –ì–æ—Ä—Å—Ç—å –º–∏–Ω–¥–∞–ª—è (20 –≥) + —è–±–ª–æ–∫–æ
–û–±–µ–¥: –ò–Ω–¥–µ–π–∫–∞ (100 –≥) + —Ç—É—à—ë–Ω—ã–µ –∫–∞–±–∞—á–∫–∏ (200 –≥) + —Ä–∏—Å –±—É—Ä—ã–π (40 –≥ —Å—É—Ö.)
–ü–µ—Ä–µ–∫—É—Å: –ü—Ä–æ—Ç–µ–∏–Ω–æ–≤—ã–π –∫–æ–∫—Ç–µ–π–ª—å –Ω–∞ –∫–µ—Ñ–∏—Ä–µ
–£–∂–∏–Ω: –û–≤–æ—â–∏ –∑–∞–ø–µ—á—ë–Ω–Ω—ã–µ + —Ñ–µ—Ç–∞ (30 –≥)
–ü–µ—Ä–µ–¥ —Å–Ω–æ–º: –†—è–∂–µ–Ω–∫–∞ 200 –º–ª`,
`–ú–µ–Ω—é –Ω–∞ –¥–µ–Ω—å 3
–ó–∞–≤—Ç—Ä–∞–∫: –û–≤—Å—è–Ω–∫–∞ (40 –≥ —Å—É—Ö.) —Å —Ç—ã–∫–≤–æ–π + —è–π—Ü–æ
–ü–µ—Ä–µ–∫—É—Å: –ö–µ—Ñ–∏—Ä (200 –º–ª) + –≥—Ä—É—à–∞
–û–±–µ–¥: –ì–æ–≤—è–¥–∏–Ω–∞ —Ç—É—à—ë–Ω–∞—è (100 –≥) + —Ñ–∞—Å–æ–ª—å —Å—Ç—Ä—É—á–∫–æ–≤–∞—è (150 –≥) + –≥—Ä–µ—á–∫–∞ (40 –≥ —Å—É—Ö.)
–ü–µ—Ä–µ–∫—É—Å: –°–º—É–∑–∏: —à–ø–∏–Ω–∞—Ç, –æ–≥—É—Ä–µ—Ü, —Å–µ–ª—å–¥–µ—Ä–µ–π
–£–∂–∏–Ω: –õ–æ—Å–æ—Å—å (100 –≥) + —Å–∞–ª–∞—Ç –∏–∑ —Ä—É–∫–∫–æ–ª—ã –∏ –∞–≤–æ–∫–∞–¥–æ
–ü–µ—Ä–µ–¥ —Å–Ω–æ–º: –ô–æ–≥—É—Ä—Ç –Ω–∞—Ç—É—Ä–∞–ª—å–Ω—ã–π (150 –º–ª)`
    ];

    function bmiAndCategory(weightBefore, heightCm) {
      const bmi = weightBefore / ((heightCm / 100) ** 2);
      let cat;
      if (bmi < 18.5) cat = "–ò–ú–¢ < 18.5";
      else if (bmi < 25) cat = "–ò–ú–¢ 18.5‚Äì24.9";
      else if (bmi < 30) cat = "–ò–ú–¢ 25.0‚Äì29.9";
      else cat = "–ò–ú–¢ ‚â• 30.0";
      return [bmi, cat];
    }

    function fillNormsTable() {
      const table = document.getElementById('norms-table');
      table.innerHTML = `
        <thead><tr>
          <th>–ö–∞—Ç–µ–≥–æ—Ä–∏—è –ò–ú–¢</th>
          <th>–ó–∞ –≤—Å—é –±–µ—Ä–µ–º–µ–Ω–Ω–æ—Å—Ç—å (–∫–≥)</th>
          <th>–ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ (–∫–≥/–Ω–µ–¥)</th>
        </tr></thead>
        <tbody>
          ${Object.entries(norms).map(([k,v]) => `
            <tr>
              <td>${k}</td>
              <td>${v.total_kg}</td>
              <td>${v.weekly_kg[0].toFixed(2)}‚Äì${v.weekly_kg[1].toFixed(2)}</td>
            </tr>
          `).join('')}
        </tbody>
      `;
    }

    function addMsg(container, text, type="info") {
      const div = document.createElement('div');
      div.className = `msg ${type}`;
      div.textContent = text;
      container.appendChild(div);
    }

    function calc() {
      const wb = parseFloat(document.getElementById('weight_before').value);
      const h  = parseFloat(document.getElementById('height').value);
      const cw = parseFloat(document.getElementById('current_weight').value);
      const gw = parseInt(document.getElementById('gest_weeks').value || "0", 10);
      const pw = parseFloat(document.getElementById('prev_weight').value || "0");
      const pwk= parseInt(document.getElementById('prev_weeks').value || "0", 10);

      const summary = document.getElementById('summary');
      summary.innerHTML = "";

      if (!(wb>0 && h>0 && cw>0 && gw>0)) {
        addMsg(summary, "–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤–≤–æ–¥–∏–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è.", "error");
        return;
      }

      const [bmi, cat] = bmiAndCategory(wb, h);
      addMsg(summary, `–ò–ú–¢ –¥–æ –±–µ—Ä–µ–º–µ–Ω–Ω–æ—Å—Ç–∏: ${bmi.toFixed(1)} ‚Üí ${cat}`, "info");

      const menuWrap = document.getElementById('menuWrap');
      const menuCard = document.getElementById('menu-card');
      const downloadBtn = document.getElementById('downloadBtn');
      menuWrap.style.display = "none";
      menuCard.innerText = "";
      downloadBtn.disabled = true;

      if (pw > 0) {
        if (!(pwk < gw)) {
          addMsg(summary, "–°—Ä–æ–∫ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –≤–∑–≤–µ—à–∏–≤–∞–Ω–∏—è –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –º–µ–Ω—å—à–µ —Ç–µ–∫—É—â–µ–≥–æ —Å—Ä–æ–∫–∞.", "error");
        } else {
          const weeksPassed = gw - pwk;
          const weightGain = cw - pw;
          const weeklyGain = weeksPassed > 0 ? (weightGain / weeksPassed) : 0;

          addMsg(summary, `–ü—Ä–∏–±–∞–≤–∫–∞ –∑–∞ ${weeksPassed} –Ω–µ–¥.: ${weightGain.toFixed(2)} –∫–≥; –≤ —Å—Ä–µ–¥–Ω–µ–º: ${weeklyGain.toFixed(2)} –∫–≥/–Ω–µ–¥`, "info");

          const [minN, maxN] = norms[cat].weekly_kg;
          if (weeklyGain > maxN) {
            addMsg(summary, `–ü—Ä–∏–±–∞–≤–∫–∞ –≤—ã—à–µ –Ω–æ—Ä–º—ã (${maxN.toFixed(2)} –∫–≥/–Ω–µ–¥). –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º —Å–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–∏—Ç–∞–Ω–∏–µ.`, "error");
            const menu = sampleMenus[Math.floor(Math.random() * sampleMenus.length)];
            menuCard.innerText = menu;   // –∑–¥–µ—Å—å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
            menuWrap.style.display = "block";
            downloadBtn.disabled = false;
          } else if (weeklyGain < minN) {
            addMsg(summary, `–ü—Ä–∏–±–∞–≤–∫–∞ –Ω–∏–∂–µ –Ω–æ—Ä–º—ã (${minN.toFixed(2)} –∫–≥/–Ω–µ–¥). –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø–∏—Ç–∞–µ—Ç–µ—Å—å –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ.`, "warn");
          } else {
            addMsg(summary, `–ü—Ä–∏–±–∞–≤–∫–∞ –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö –Ω–æ—Ä–º—ã (${minN.toFixed(2)}‚Äì${maxN.toFixed(2)} –∫–≥/–Ω–µ–¥). –û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞!`, "ok");
          }
        }
      } else {
        addMsg(summary, "–í–≤–µ–¥–∏—Ç–µ –ø—Ä–µ–¥—ã–¥—É—â–∏–π –≤–µ—Å –∏ —Å—Ä–æ–∫, —á—Ç–æ–±—ã —Ä–∞—Å—Å—á–∏—Ç–∞—Ç—å –¥–∏–Ω–∞–º–∏–∫—É –ø—Ä–∏–±–∞–≤–∫–∏.", "info");
      }
    }

    function downloadPDF() {
      const element = document.getElementById('menu-card');
      if (!element || !element.innerText.trim()) {
        alert("–ú–µ–Ω—é –ø—É—Å—Ç–æ–µ ‚Äî —Å–Ω–∞—á–∞–ª–∞ —Ä–∞—Å—Å—á–∏—Ç–∞–π—Ç–µ –¥–∞–Ω–Ω—ã–µ.");
        return;
      }
      const opt = {
        margin:       10,
        filename:     'SmartMama_–º–µ–Ω—é.pdf',
        image:        { type: 'jpeg', quality: 0.98 },
        html2canvas:  { scale: 2, useCORS: true },
        jsPDF:        { unit: 'mm', format: 'a4', orientation: 'portrait' }
      };
      html2pdf().set(opt).from(element).save();
    }

    document.getElementById('calcBtn').addEventListener('click', calc);
    document.getElementById('downloadBtn').addEventListener('click', downloadPDF);
    document.addEventListener('DOMContentLoaded', fillNormsTable);
  </script>
</body>
</html>
